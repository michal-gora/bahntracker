<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>S-Bahn Live</title>
    <!-- Load Leaflet from CDN -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"/>
    <style>
        /* Force full screen height */
        html, body { 
            width: 100%; 
            height: 100%; 
            margin: 0; 
            padding: 0; 
            overflow: hidden; 
            background: #e0e0e0; 
        }
        #map { 
            width: 100vw; 
            height: 100vh; /* Use Viewport Height to guarantee visibility */
        }
        
        .icon-container { position: relative; width: 30px; height: 30px; display: flex; justify-content: center; align-items: center; }
        .train-circle { width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-family: sans-serif; font-weight: bold; font-size: 10px; color: white; z-index: 3; box-shadow: 0 1px 3px rgba(0,0,0,0.5); }
        .driving { border-radius: 50%; border: 2px solid white; }
        .boarding { border-radius: 50%; border: 3px double white; transform: scale(1.0); }
        .arrow-pointer { position: absolute; top: 0; left: 0; right: 0; bottom: 0; z-index: 5; pointer-events: none; }
        .arrow-pointer::before { content: ''; position: absolute; top: -6px; left: 50%; margin-left: -7px; width: 0; height: 0; border-left: 7px solid transparent; border-right: 7px solid transparent; border-bottom: 11px solid white; transform-origin: center 21px; }
    </style>
</head>
<body>
    <div id="map"></div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
    
    <script>
    // WRAPPED IN TRY/CATCH TO CATCH ERRORS
    try {
        console.log("Initializing Map...");

        // ============================================================
        // 1. EMBEDDED ROUTE GEOJSON (From your paste.txt)
        // ============================================================
        const ROUTES_DATA = {
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "geometry": {
        "type": "LineString",
        "coordinates": [
          [
            11.940173194542808,
            48.043423495400994
          ],
          [
            11.938879620533674,
            48.04527326131339
          ],
          [
            11.937271636175103,
            48.047062906663534
          ],
          [
            11.9366607817819,
            48.047663444859765
          ],
          [
            11.935969079013127,
            48.048269981330236
          ],
          [
            11.934953982742073,
            48.04906867687525
          ],
          [
            11.934136515833524,
            48.04965117634138
          ],
          [
            11.932501582016426,
            48.050708065766926
          ],
          [
            11.91899990329611,
            48.0585019554322
          ],
          [
            11.91785904288528,
            48.059066336145875
          ],
          [
            11.917221239033553,
            48.059324508239676
          ],
          [
            11.913295601241952,
            48.060627356960374
          ],
          [
            11.912280504970896,
            48.06101760476813
          ],
          [
            11.911193543477111,
            48.061539931819574
          ],
          [
            11.907465535048015,
            48.063497110186205
          ],
          [
            11.906917562724702,
            48.063761263529976
          ],
          [
            11.90598331482922,
            48.06414548415562
          ],
          [
            11.905049066933733,
            48.06445766130216
          ],
          [
            11.893927923716335,
            48.06760334072775
          ],
          [
            11.892589433942996,
            48.068041559436175
          ],
          [
            11.891906714327066,
            48.068311692397465
          ],
          [
            11.890909584361692,
            48.06877391662026
          ],
          [
            11.890325679427015,
            48.06910407423775
          ],
          [
            11.88728039061385,
            48.07098293090005
          ],
          [
            11.881108964611949,
            48.07452435917983
          ],
          [
            11.87548551093336,
            48.07783747478291
          ],
          [
            11.873715829823645,
            48.07877375139661
          ],
          [
            11.872233609604848,
            48.07942193291704
          ],
          [
            11.870706473621844,
            48.07999808741266
          ],
          [
            11.863924193226744,
            48.08247067718742
          ],
          [
            11.856962249774815,
            48.084811125974156
          ],
          [
            11.855722574682732,
            48.08517718653825
          ],
          [
            11.854851208857136,
            48.08539322105857
          ],
          [
            11.853252207651403,
            48.08572327204586
          ],
          [
            11.842319710643668,
            48.08775753955604
          ],
          [
            11.83242027621267,
            48.089539707799055
          ],
          [
            11.830192454308055,
            48.08997173928479
          ],
          [
            11.826006305084057,
            48.09070378435038
          ],
          [
            11.823724584262393,
            48.09117180770186
          ],
          [
            11.794187977720544,
            48.09758569851723
          ],
          [
            11.787037388058954,
            48.099199545050524
          ],
          [
            11.77401181643922,
            48.101977162268255
          ],
          [
            11.764552556497442,
            48.10409476959791
          ],
          [
            11.753287682834582,
            48.106500217696635
          ],
          [
            11.739920751406883,
            48.10940340162577
          ],
          [
            11.736147827213582,
            48.11023713694623
          ],
          [
            11.73246473454869,
            48.11109485053453
          ],
          [
            11.730973531177053,
            48.11131677409679
          ],
          [
            11.727308404817846,
            48.11221645439563
          ],
          [
            11.724990751384818,
            48.11268428192607
          ],
          [
            11.702505919823306,
            48.11755423351478
          ],
          [
            11.700197249543118,
            48.118099975188734
          ],
          [
            11.698840793464097,
            48.118363848204694
          ],
          [
            11.672439307263826,
            48.124060775979046
          ],
          [
            11.667992646607432,
            48.125074163254055
          ],
          [
            11.663339373435695,
            48.12603356473465
          ],
          [
            11.660383916150941,
            48.12673511572375
          ],
          [
            11.659611365006597,
            48.12696296782958
          ],
          [
            11.658937628543509,
            48.12720880712586
          ],
          [
            11.656422345747973,
            48.12838402262499
          ],
          [
            11.655515047311015,
            48.128767760637274
          ],
          [
            11.651751106270552,
            48.13058448136784
          ],
          [
            11.65067312792961,
            48.13107012849829
          ],
          [
            11.649595149588666,
            48.13148382428314
          ],
          [
            11.64797818207725,
            48.13198744943598
          ],
          [
            11.646918170041989,
            48.13223926016019
          ],
          [
            11.645813242242523,
            48.13244910148709
          ],
          [
            11.641950486520809,
            48.133114592594524
          ],
          [
            11.638914180860484,
            48.13344433724502
          ],
          [
            11.633596154378498,
            48.13397192428137
          ],
          [
            11.62751455990501,
            48.13452948196228
          ],
          [
            11.622160600811656,
            48.13491317405384
          ],
          [
            11.620732279509905,
            48.13487120787098
          ],
          [
            11.620157357728068,
            48.13481725129975
          ],
          [
            11.617848687447882,
            48.134553462801996
          ],
          [
            11.616573079744432,
            48.134355620539345
          ],
          [
            11.615980191656913,
            48.134247706256595
          ],
          [
            11.614776449176192,
            48.13394194789046
          ],
          [
            11.614129662171626,
            48.13371412674768
          ],
          [
            11.613590673001154,
            48.13347431392643
          ],
          [
            11.613060666983525,
            48.13318653706251
          ],
          [
            11.6122701495335,
            48.13270090994746
          ],
          [
            11.608784686231116,
            48.12993694471623
          ],
          [
            11.605532784902604,
            48.1277124742041
          ],
          [
            11.604068530989489,
            48.12679507690223
          ],
          [
            11.60265817599342,
            48.12609952292806
          ],
          [
            11.602235967809884,
            48.12593762539303
          ],
          [
            11.601687995486571,
            48.12579371604457
          ],
          [
            11.6011490063161,
            48.125709768738425
          ],
          [
            11.600663916062675,
            48.1256737912795
          ],
          [
            11.600214758420616,
            48.12565580254061
          ],
          [
            11.599756617625713,
            48.12566779503391
          ],
          [
            11.599307459983654,
            48.12572775745843
          ],
          [
            11.598885251800118,
            48.125829693419476
          ],
          [
            11.59835524578249,
            48.126009579916044
          ],
          [
            11.597825239764857,
            48.12627341230469
          ],
          [
            11.594600287894869,
            48.12821613634299
          ],
          [
            11.593073151911865,
            48.12918747080512
          ],
          [
            11.589964981028812,
            48.131190040662986
          ],
          [
            11.589390059246975,
            48.13151979767215
          ],
          [
            11.588842086923663,
            48.131765615155885
          ],
          [
            11.58844682819865,
            48.131903512253515
          ],
          [
            11.586731046005982,
            48.13233518773032
          ],
          [
            11.58551832037242,
            48.132796836655174
          ],
          [
            11.58438644311443,
            48.133348411746915
          ],
          [
            11.583137784869503,
            48.1342117347786
          ],
          [
            11.581493867899566,
            48.135200941240896
          ],
          [
            11.581035727104664,
            48.13541676557279
          ],
          [
            11.579975715069404,
            48.13575848557627
          ],
          [
            11.577837724693198,
            48.13632201885972
          ],
          [
            11.576436352849973,
            48.136849576328004
          ],
          [
            11.575394307120394,
            48.13714332756875
          ],
          [
            11.572618512892465,
            48.13776679402077
          ],
          [
            11.571342905189015,
            48.138156456708565
          ],
          [
            11.570705101337289,
            48.138300331414925
          ],
          [
            11.570166112166817,
            48.13838425814076
          ],
          [
            11.569115083284396,
            48.138480174230885
          ],
          [
            11.567821509275266,
            48.13869598477844
          ],
          [
            11.566339289056469,
            48.13909762977105
          ],
          [
            11.566078777624075,
            48.13919953919477
          ],
          [
            11.565620636829173,
            48.13948728235796
          ],
          [
            11.563877905177982,
            48.14015867680017
          ],
          [
            11.561865678941553,
            48.140794095595304
          ],
          [
            11.560024132609108,
            48.141255668467565
          ],
          [
            11.559027002643735,
            48.141441495335265
          ],
          [
            11.556862062809008,
            48.14194502282168
          ],
          [
            11.555056449087926,
            48.14224473921864
          ],
          [
            11.554445594694727,
            48.142280705068686
          ],
          [
            11.553879656065732,
            48.14226272214681
          ],
          [
            11.55311608807423,
            48.14216681312378
          ],
          [
            11.55153505317418,
            48.14192104543432
          ],
          [
            11.550519956903123,
            48.14184311884807
          ],
          [
            11.549495877479227,
            48.14184311884807
          ],
          [
            11.548525696972378,
            48.14190306238646
          ],
          [
            11.543665811285292,
            48.14229868798425
          ],
          [
            11.541707483965912,
            48.142394596760894
          ],
          [
            11.538545414165812,
            48.142622379387234
          ],
          [
            11.536524204776542,
            48.14267033349556
          ],
          [
            11.53244585338664,
            48.14272428181388
          ],
          [
            11.53072108804113,
            48.142688316274636
          ],
          [
            11.519240618710082,
            48.14355747641903
          ],
          [
            11.517084662028195,
            48.14354548810335
          ],
          [
            11.51373394601843,
            48.143407622271695
          ],
          [
            11.512602068760438,
            48.14341361644599
          ],
          [
            11.511721719782,
            48.14345557564644
          ],
          [
            11.507140311832993,
            48.143917124587716
          ],
          [
            11.503708747447655,
            48.14434270499872
          ],
          [
            11.49811224322759,
            48.144858192038626
          ],
          [
            11.496890534441189,
            48.14501403593851
          ],
          [
            11.493009812413792,
            48.145589455469775
          ],
          [
            11.492354042256384,
            48.1456613824576
          ],
          [
            11.491455726972266,
            48.145703339820614
          ],
          [
            11.48848230338183,
            48.14569135200612
          ],
          [
            11.487745684848852,
            48.145715327632324
          ],
          [
            11.487386358735204,
            48.145703339820614
          ],
          [
            11.473417556067144,
            48.14675226274896
          ],
          [
            11.472007201071078,
            48.146890119597145
          ],
          [
            11.470489048240916,
            48.147141857234004
          ],
          [
            11.469599716109638,
            48.14735163765486
          ],
          [
            11.468863097576659,
            48.14756741090745
          ],
          [
            11.467147315383992,
            48.14812482094457
          ],
          [
            11.464443386378791,
            48.1491077658288
          ],
          [
            11.461766406832115,
            48.14995883704555
          ],
          [
            11.459322989259311,
            48.15066605450232
          ],
          [
            11.455927357485338,
            48.15155305922943
          ],
          [
            11.455199722105203,
            48.1516789167662
          ],
          [
            11.454265474209716,
            48.15178679440917
          ],
          [
            11.45344800730117,
            48.15182874676463
          ],
          [
            11.452585624628414,
            48.15181676038086
          ],
          [
            11.451705275649976,
            48.15175083522004
          ],
          [
            11.450645263614716,
            48.15160100499411
          ],
          [
            11.449145077090236,
            48.151265383700526
          ],
          [
            11.448237778653274,
            48.15103763942977
          ],
          [
            11.447474210661774,
            48.15080390083773
          ],
          [
            11.446450131237876,
            48.1504143341518
          ],
          [
            11.445893175761723,
            48.15015661918041
          ],
          [
            11.444976894171921,
            48.14970711322601
          ],
          [
            11.444231292486101,
            48.1492516098425
          ],
          [
            11.444096545193483,
            48.149149720374446
          ],
          [
            11.443934848442343,
            48.1490178631155
          ],
          [
            11.443602471787218,
            48.14872417982118
          ],
          [
            11.443153314145158,
            48.14815478905464
          ],
          [
            11.442946701629811,
            48.147885075434004
          ],
          [
            11.431690811119793,
            48.12949925328077
          ],
          [
            11.430891310516927,
            48.128258107964946
          ],
          [
            11.430909276822609,
            48.12822213229109
          ],
          [
            11.430648765390215,
            48.12779641823692
          ],
          [
            11.425618199799144,
            48.11963521737604
          ],
          [
            11.423417327353052,
            48.1161268817291
          ],
          [
            11.422779523501328,
            48.11526925213195
          ],
          [
            11.413742471743085,
            48.10545647100089
          ],
          [
            11.41121820579471,
            48.1027690256455
          ],
          [
            11.410562435637303,
            48.10213913531508
          ],
          [
            11.408765805069063,
            48.10020742350594
          ],
          [
            11.406753578832637,
            48.098203645740035
          ],
          [
            11.404929998805873,
            48.0965837683042
          ],
          [
            11.401085209389842,
            48.09351186056658
          ],
          [
            11.3863348724246,
            48.08163049010928
          ],
          [
            11.385247910930813,
            48.08056823394686
          ],
          [
            11.37777392776694,
            48.07257960500799
          ],
          [
            11.37618390971405,
            48.07071281195979
          ],
          [
            11.37453999274411,
            48.068317695336056
          ],
          [
            11.374207616088986,
            48.067891484956135
          ],
          [
            11.366095829073386,
            48.059882876014484
          ],
          [
            11.365565823055755,
            48.05930649627514
          ],
          [
            11.36491903605119,
            48.05841789820081
          ],
          [
            11.364568693090384,
            48.05779346875686
          ],
          [
            11.364281232199465,
            48.05713901053823
          ],
          [
            11.360148981892516,
            48.04592186479921
          ],
          [
            11.356986912092415,
            48.03556725593825
          ],
          [
            11.356690468048654,
            48.03476234417948
          ],
          [
            11.35642995661626,
            48.03422172474549
          ],
          [
            11.356133512572502,
            48.03369912056759
          ],
          [
            11.355855034834423,
            48.03331467273118
          ],
          [
            11.355567573943505,
            48.03296025734105
          ],
          [
            11.355064517384399,
            48.03246166885198
          ],
          [
            11.352270756850785,
            48.03021495726127
          ],
          [
            11.351606003540539,
            48.029608208188876
          ],
          [
            11.351102946981431,
            48.02897742187672
          ],
          [
            11.350689721950737,
            48.02825050617059
          ],
          [
            11.350402261059818,
            48.027499549426345
          ],
          [
            11.350303446378565,
            48.02670652722617
          ],
          [
            11.350321412684247,
            48.02597357161513
          ],
          [
            11.350644806186532,
            48.024195209760684
          ],
          [
            11.350725654562101,
            48.023450202099525
          ],
          [
            11.350707688256419,
            48.02290345575561
          ],
          [
            11.350554974658118,
            48.022056287878556
          ],
          [
            11.3502675137672,
            48.02129322404321
          ],
          [
            11.349926153959235,
            48.02066834445895
          ],
          [
            11.348372068517707,
            48.01861339857048
          ],
          [
            11.347985792945536,
            48.018006512918944
          ],
          [
            11.347509685844953,
            48.01698500608668
          ],
          [
            11.347276123871081,
            48.01598751517897
          ],
          [
            11.347213241801194,
            48.01494193170495
          ],
          [
            11.347294090176764,
            48.01249614503059
          ],
          [
            11.347365955399493,
            48.00623392170215
          ],
          [
            11.347536635303477,
            47.99973050117297
          ],
          [
            11.347455786927906,
            47.99857638895361
          ],
          [
            11.347365955399493,
            47.998077467865926
          ],
          [
            11.347150359731305,
            47.99762062022876
          ],
          [
            11.346835949381864,
            47.99713371237272
          ],
          [
            11.346494589573899,
            47.99683314967407
          ],
          [
            11.34612628030741,
            47.99660472085209
          ],
          [
            11.345695088971032,
            47.996370279693714
          ],
          [
            11.345425594385796,
            47.99626808706054
          ],
          [
            11.34387150894427,
            47.995931451072636
          ],
          [
            11.342308440349901,
            47.99573307526556
          ],
          [
            11.341931147930572,
            47.99566093841935
          ],
          [
            11.341194529397592,
            47.99540244722555
          ],
          [
            11.340763338061215,
            47.99516800060431
          ],
          [
            11.340484860323137,
            47.99495759888341
          ],
          [
            11.340170449973696,
            47.99461494281584
          ],
          [
            11.339119421091278,
            47.99308197991596
          ],
          [
            11.337448554662814,
            47.991398674077644
          ],
          [
            11.334313434321237,
            47.98725029316502
          ],
          [
            11.333621731552466,
            47.986456651862625
          ],
          [
            11.3331276581462,
            47.985957613582336
          ],
          [
            11.33200476404105,
            47.98494148457938
          ],
          [
            11.314352868708102,
            47.970906035775045
          ],
          [
            11.313786930079106,
            47.97040684715974
          ],
          [
            11.313203025144428,
            47.969817437522295
          ],
          [
            11.312816749572256,
            47.969330267336005
          ],
          [
            11.31239454138872,
            47.96865062717642
          ],
          [
            11.31148724295176,
            47.966653756559154
          ],
          [
            11.310768590724464,
            47.9655530388449
          ],
          [
            11.310373331999452,
            47.96508988831434
          ],
          [
            11.309510949326699,
            47.964271846063156
          ],
          [
            11.306780070862974,
            47.96214848476529
          ],
          [
            11.30636684583228,
            47.961859749009136
          ],
          [
            11.305953620801583,
            47.96155296549992
          ],
          [
            11.305234968574288,
            47.96075892913363
          ],
          [
            11.302791551001484,
            47.95734804320727
          ],
          [
            11.3020100167043,
            47.956493782547085
          ],
          [
            11.301237465559957,
            47.95583803766955
          ],
          [
            11.295164854239308,
            47.95166874943402
          ],
          [
            11.294302471566553,
            47.95092269412348
          ],
          [
            11.291320064823276,
            47.947974466958065
          ],
          [
            11.290242086482333,
            47.9469575904185
          ],
          [
            11.289505467949356,
            47.94622951859412
          ],
          [
            11.289029360848772,
            47.94558567794036
          ],
          [
            11.288634102123758,
            47.944767326842815
          ],
          [
            11.28848138852546,
            47.94416558982875
          ],
          [
            11.288508337983984,
            47.94311855072579
          ],
          [
            11.289325804892531,
            47.939568087842
          ],
          [
            11.289433602726627,
            47.93897832632375
          ],
          [
            11.289451569032309,
            47.938484847230534
          ],
          [
            11.289433602726627,
            47.93799136342707
          ],
          [
            11.288445455914095,
            47.93144924890745
          ],
          [
            11.28826579285727,
            47.930702901737945
          ],
          [
            11.285139655668535,
            47.92075258357704
          ],
          [
            11.285013891528758,
            47.92045157619032
          ],
          [
            11.284564733886699,
            47.91971109056538
          ],
          [
            11.28406167732759,
            47.919078960304724
          ],
          [
            11.281034354820108,
            47.91556899178647
          ],
          [
            11.280621129789413,
            47.91514151794885
          ],
          [
            11.280171972147354,
            47.914780269699
          ],
          [
            11.279731797658135,
            47.91447922756423
          ],
          [
            11.277009902347253,
            47.912781317128804
          ],
          [
            11.276650576233605,
            47.91252241099692
          ],
          [
            11.276003789229039,
            47.91192631986194
          ],
          [
            11.275455816905728,
            47.91120377594725
          ],
          [
            11.274773097289795,
            47.91016811207652
          ],
          [
            11.274162242896594,
            47.90912640599702
          ],
          [
            11.272859685734621,
            47.90709110471541
          ],
          [
            11.272796803664733,
            47.90710916987174
          ]
        ]
      },
      "properties": {
        "name": "S6",
        "color": "#00a76c"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "LineString",
        "coordinates": [
          [
            11.786130089621992,
            48.353772042182115
          ],
          [
            11.7839292171759,
            48.35365265066922
          ],
          [
            11.763735089588891,
            48.352094565778714
          ],
          [
            11.742624680412083,
            48.35042897407208
          ],
          [
            11.74116940965181,
            48.35029763477591
          ],
          [
            11.739911768254043,
            48.35005286518431
          ],
          [
            11.739417694847777,
            48.34993943497491
          ],
          [
            11.738061238768756,
            48.34958720271532
          ],
          [
            11.736749698453941,
            48.34915138654982
          ],
          [
            11.736228675589151,
            48.348948402406
          ],
          [
            11.735177646706733,
            48.34846481927645
          ],
          [
            11.734153567282837,
            48.34791555879798
          ],
          [
            11.730209963185553,
            48.34551545986846
          ],
          [
            11.729257748984384,
            48.34484675545759
          ],
          [
            11.728503164145724,
            48.34426163190105
          ],
          [
            11.727389253193417,
            48.34330034290413
          ],
          [
            11.726652634660438,
            48.34257190065839
          ],
          [
            11.725421942721194,
            48.341156782278794
          ],
          [
            11.724496677978552,
            48.33984313512049
          ],
          [
            11.724011587725126,
            48.339031045399835
          ],
          [
            11.721244776650039,
            48.3340149104105
          ],
          [
            11.720589006492633,
            48.33259955448615
          ],
          [
            11.720247646684665,
            48.3316977671416
          ],
          [
            11.719726623819877,
            48.33000164707608
          ],
          [
            11.719385264011912,
            48.328448811634644
          ],
          [
            11.718891190605646,
            48.32370042531885
          ],
          [
            11.718720510701663,
            48.32261928438683
          ],
          [
            11.718388134046538,
            48.32113790490561
          ],
          [
            11.71808270684994,
            48.320122418311676
          ],
          [
            11.71623217736465,
            48.31457869982587
          ],
          [
            11.71584590179248,
            48.31359295404513
          ],
          [
            11.714381647879366,
            48.30932116892873
          ],
          [
            11.711246527537789,
            48.30085421086822
          ],
          [
            11.710994999258237,
            48.29994588636205
          ],
          [
            11.710788386742887,
            48.29872679385968
          ],
          [
            11.710725504673,
            48.297501696086734
          ],
          [
            11.710815336201412,
            48.29530839884209
          ],
          [
            11.710815336201412,
            48.29447767037963
          ],
          [
            11.710752454131523,
            48.293419816730356
          ],
          [
            11.710042785057068,
            48.288901279847444
          ],
          [
            11.709934987222974,
            48.288082401666564
          ],
          [
            11.709863122000245,
            48.28692877727955
          ],
          [
            11.70989905461161,
            48.285589823037824
          ],
          [
            11.710339229100827,
            48.27863745618414
          ],
          [
            11.710384144865033,
            48.27702327178793
          ],
          [
            11.71034821225367,
            48.27559437711999
          ],
          [
            11.709809223083198,
            48.26855095672636
          ],
          [
            11.70953074534512,
            48.26643415341276
          ],
          [
            11.709243284454201,
            48.26503486241194
          ],
          [
            11.708865992034873,
            48.26360563248432
          ],
          [
            11.708569547991111,
            48.262660763978204
          ],
          [
            11.707859878916658,
            48.26074705273481
          ],
          [
            11.707383771816074,
            48.25963467515011
          ],
          [
            11.706799866881397,
            48.25840863955644
          ],
          [
            11.705955450514326,
            48.25686558711798
          ],
          [
            11.705146966758617,
            48.255549769180334
          ],
          [
            11.704392381919957,
            48.25444325970313
          ],
          [
            11.703377285648902,
            48.2530795285945
          ],
          [
            11.701814217054533,
            48.25119536656659
          ],
          [
            11.70020623269596,
            48.24949058871835
          ],
          [
            11.684144355415903,
            48.23443224119468
          ],
          [
            11.6826172194329,
            48.23293633494403
          ],
          [
            11.681916533511286,
            48.23214049499679
          ],
          [
            11.681620089467527,
            48.23174556230751
          ],
          [
            11.681215847589673,
            48.23108135045618
          ],
          [
            11.680766689947614,
            48.2301598170329
          ],
          [
            11.67992227358054,
            48.22780803639622
          ],
          [
            11.6794551496328,
            48.22579726801483
          ],
          [
            11.678251407152079,
            48.22033906989862
          ],
          [
            11.677981912566842,
            48.21924975455743
          ],
          [
            11.67764953591172,
            48.21822027040363
          ],
          [
            11.67713749619977,
            48.21705908320068
          ],
          [
            11.676400877666792,
            48.21568238383884
          ],
          [
            11.675430697159943,
            48.21435353456268
          ],
          [
            11.674496449264458,
            48.21325810584868
          ],
          [
            11.67323880786669,
            48.21199504146732
          ],
          [
            11.67217879583143,
            48.211103095718684
          ],
          [
            11.649693964269918,
            48.19387172620948
          ],
          [
            11.648714800610229,
            48.19296748805788
          ],
          [
            11.648337508190899,
            48.19248242657962
          ],
          [
            11.646891220583466,
            48.19024270045445
          ],
          [
            11.645588663421494,
            48.1878471631064
          ],
          [
            11.644331022023726,
            48.185679105280485
          ],
          [
            11.643980679062919,
            48.18494841319572
          ],
          [
            11.64375610024189,
            48.18428958353326
          ],
          [
            11.64361236979643,
            48.183522934720166
          ],
          [
            11.64361236979643,
            48.182492732320895
          ],
          [
            11.64375610024189,
            48.18172605663271
          ],
          [
            11.64422322418963,
            48.18028850881084
          ],
          [
            11.644313055718044,
            48.17962362930922
          ],
          [
            11.644537634539073,
            48.179078541483406
          ],
          [
            11.644861028041355,
            48.17807221027061
          ],
          [
            11.645004758486815,
            48.17749715499435
          ],
          [
            11.645202387849322,
            48.17630509278449
          ],
          [
            11.645301202530575,
            48.17491531692498
          ],
          [
            11.64534611829478,
            48.170799682124205
          ],
          [
            11.645444932976034,
            48.17009274217711
          ],
          [
            11.64601087160503,
            48.16760639292112
          ],
          [
            11.646864271124944,
            48.16413728495916
          ],
          [
            11.64736732768405,
            48.1625794053888
          ],
          [
            11.647645805422128,
            48.161398980515145
          ],
          [
            11.647852417937473,
            48.16029043496265
          ],
          [
            11.64834649134374,
            48.156760906063504
          ],
          [
            11.648921413125576,
            48.152685765947844
          ],
          [
            11.649110059335241,
            48.15176282161922
          ],
          [
            11.649307688697748,
            48.149635191907926
          ],
          [
            11.65029583551028,
            48.14132160711053
          ],
          [
            11.650655161623927,
            48.140134698578436
          ],
          [
            11.65112228557167,
            48.138965746687134
          ],
          [
            11.651328898087018,
            48.138246378447285
          ],
          [
            11.651373813851222,
            48.137527000127534
          ],
          [
            11.651319914934176,
            48.137209271493845
          ],
          [
            11.651185167641557,
            48.136825596560676
          ],
          [
            11.650924656209163,
            48.136369978853565
          ],
          [
            11.650637195318245,
            48.13603425795586
          ],
          [
            11.650017357772201,
            48.135524677398536
          ],
          [
            11.649622099047189,
            48.13527887790985
          ],
          [
            11.649056160418194,
            48.13502708209157
          ],
          [
            11.648076996758505,
            48.13474530911659
          ],
          [
            11.647016984723244,
            48.13460741965043
          ],
          [
            11.645885107465253,
            48.134631400453756
          ],
          [
            11.64023470432814,
            48.135326838878086
          ],
          [
            11.63917469229288,
            48.13542276068018
          ],
          [
            11.638545871593996,
            48.1354467411027
          ],
          [
            11.63774637099113,
            48.13544074599812
          ],
          [
            11.637216364973499,
            48.135410770464716
          ],
          [
            11.634907694693311,
            48.135152980155056
          ],
          [
            11.633946497339304,
            48.13511101416819
          ],
          [
            11.632051052089812,
            48.135224921767026
          ],
          [
            11.630263404674414,
            48.13538079491381
          ],
          [
            11.629149493722105,
            48.135398780246454
          ],
          [
            11.621720426322437,
            48.13511700931128
          ],
          [
            11.621046689859348,
            48.135057057848975
          ],
          [
            11.618971581553032,
            48.13472132836647
          ],
          [
            11.616573079744432,
            48.134355620539345
          ],
          [
            11.615980191656913,
            48.134247706256595
          ],
          [
            11.614776449176192,
            48.13394194789046
          ],
          [
            11.614129662171626,
            48.13371412674768
          ],
          [
            11.613590673001154,
            48.13347431392643
          ],
          [
            11.613060666983525,
            48.13318653706251
          ],
          [
            11.6122701495335,
            48.13270090994746
          ],
          [
            11.608784686231116,
            48.12993694471623
          ],
          [
            11.604957863120767,
            48.12743066109042
          ],
          [
            11.604068530989489,
            48.12679507690223
          ],
          [
            11.60265817599342,
            48.12609952292806
          ],
          [
            11.602235967809884,
            48.12593762539303
          ],
          [
            11.601687995486571,
            48.12579371604457
          ],
          [
            11.6011490063161,
            48.125709768738425
          ],
          [
            11.600663916062675,
            48.1256737912795
          ],
          [
            11.600214758420616,
            48.12565580254061
          ],
          [
            11.599756617625713,
            48.12566779503391
          ],
          [
            11.599307459983654,
            48.12572775745843
          ],
          [
            11.598885251800118,
            48.125829693419476
          ],
          [
            11.59835524578249,
            48.126009579916044
          ],
          [
            11.597825239764857,
            48.12627341230469
          ],
          [
            11.594600287894869,
            48.12821613634299
          ],
          [
            11.593073151911865,
            48.12918747080512
          ],
          [
            11.589964981028812,
            48.131190040662986
          ],
          [
            11.589390059246975,
            48.13151979767215
          ],
          [
            11.588842086923663,
            48.131765615155885
          ],
          [
            11.58844682819865,
            48.131903512253515
          ],
          [
            11.586731046005982,
            48.13233518773032
          ],
          [
            11.58551832037242,
            48.132796836655174
          ],
          [
            11.58438644311443,
            48.133348411746915
          ],
          [
            11.583137784869503,
            48.1342117347786
          ],
          [
            11.581493867899566,
            48.135200941240896
          ],
          [
            11.581035727104664,
            48.13541676557279
          ],
          [
            11.579975715069404,
            48.13575848557627
          ],
          [
            11.577837724693198,
            48.13632201885972
          ],
          [
            11.576436352849973,
            48.136849576328004
          ],
          [
            11.575394307120394,
            48.13714332756875
          ],
          [
            11.572618512892465,
            48.13776679402077
          ],
          [
            11.571342905189015,
            48.138156456708565
          ],
          [
            11.570705101337289,
            48.138300331414925
          ],
          [
            11.570166112166817,
            48.13838425814076
          ],
          [
            11.569115083284396,
            48.138480174230885
          ],
          [
            11.567821509275266,
            48.13869598477844
          ],
          [
            11.566339289056469,
            48.13909762977105
          ],
          [
            11.566078777624075,
            48.13919953919477
          ],
          [
            11.565620636829173,
            48.13948728235796
          ],
          [
            11.563877905177982,
            48.14015867680017
          ],
          [
            11.561865678941553,
            48.140794095595304
          ],
          [
            11.560024132609108,
            48.141255668467565
          ],
          [
            11.559027002643735,
            48.141441495335265
          ],
          [
            11.556862062809008,
            48.14194502282168
          ],
          [
            11.555056449087926,
            48.14224473921864
          ],
          [
            11.554445594694727,
            48.142280705068686
          ],
          [
            11.553879656065732,
            48.14226272214681
          ],
          [
            11.55311608807423,
            48.14216681312378
          ],
          [
            11.55153505317418,
            48.14192104543432
          ],
          [
            11.550519956903123,
            48.14184311884807
          ],
          [
            11.549495877479227,
            48.14184311884807
          ],
          [
            11.548525696972378,
            48.14190306238646
          ],
          [
            11.543665811285292,
            48.14229868798425
          ],
          [
            11.541707483965912,
            48.142394596760894
          ],
          [
            11.538545414165812,
            48.142622379387234
          ],
          [
            11.536524204776542,
            48.14267033349556
          ],
          [
            11.53244585338664,
            48.14272428181388
          ],
          [
            11.53072108804113,
            48.142688316274636
          ],
          [
            11.519240618710082,
            48.14355747641903
          ],
          [
            11.517084662028195,
            48.14354548810335
          ],
          [
            11.51373394601843,
            48.143407622271695
          ],
          [
            11.512602068760438,
            48.14341361644599
          ],
          [
            11.511721719782,
            48.14345557564644
          ],
          [
            11.507140311832993,
            48.143917124587716
          ],
          [
            11.503708747447655,
            48.14434270499872
          ],
          [
            11.49811224322759,
            48.144858192038626
          ],
          [
            11.496890534441189,
            48.14501403593851
          ],
          [
            11.493009812413792,
            48.145589455469775
          ],
          [
            11.492354042256384,
            48.1456613824576
          ],
          [
            11.491455726972266,
            48.145703339820614
          ],
          [
            11.487377375582362,
            48.145811230025174
          ],
          [
            11.47833134067128,
            48.146380646792075
          ],
          [
            11.473417556067144,
            48.14675226274896
          ],
          [
            11.472007201071078,
            48.146890119597145
          ],
          [
            11.470489048240916,
            48.147141857234004
          ],
          [
            11.469599716109638,
            48.14735163765486
          ],
          [
            11.468863097576659,
            48.14756741090745
          ],
          [
            11.461856238360527,
            48.1498509555598
          ],
          [
            11.457005335826281,
            48.15134329598219
          ],
          [
            11.455927357485338,
            48.15155305922943
          ],
          [
            11.455199722105203,
            48.1516789167662
          ],
          [
            11.454265474209716,
            48.15178679440917
          ],
          [
            11.45344800730117,
            48.15182874676463
          ],
          [
            11.452585624628414,
            48.15181676038086
          ],
          [
            11.451705275649976,
            48.15175083522004
          ],
          [
            11.450645263614716,
            48.15160100499411
          ],
          [
            11.449145077090236,
            48.151265383700526
          ],
          [
            11.448237778653274,
            48.15103763942977
          ],
          [
            11.447474210661774,
            48.15080390083773
          ],
          [
            11.446450131237876,
            48.1504143341518
          ],
          [
            11.445893175761723,
            48.15015661918041
          ],
          [
            11.444976894171921,
            48.14970711322601
          ],
          [
            11.444231292486101,
            48.1492516098425
          ],
          [
            11.444096545193483,
            48.149149720374446
          ],
          [
            11.443934848442343,
            48.1490178631155
          ],
          [
            11.443602471787218,
            48.14872417982118
          ],
          [
            11.443072465769589,
            48.14814280181271
          ],
          [
            11.442542459751957,
            48.14746551809566
          ],
          [
            11.441518380328061,
            48.14611691770645
          ],
          [
            11.440161924249042,
            48.14474430581256
          ],
          [
            11.439748699218345,
            48.14436668125491
          ],
          [
            11.439344457340491,
            48.14407896544149
          ],
          [
            11.43850004097342,
            48.14364139455045
          ],
          [
            11.437961051802947,
            48.143443587306955
          ],
          [
            11.437197483811447,
            48.14324577930118
          ],
          [
            11.436047640247773,
            48.14308393582038
          ],
          [
            11.430855377905562,
            48.142526471036184
          ],
          [
            11.425923626995747,
            48.142202779028416
          ],
          [
            11.422087820732557,
            48.14169325969586
          ],
          [
            11.410068362231037,
            48.14000881273056
          ],
          [
            11.404786268360414,
            48.13923550717836
          ],
          [
            11.403887953076294,
            48.139055667008385
          ],
          [
            11.403133368237635,
            48.13886383679934
          ],
          [
            11.394428693134516,
            48.13621410870977
          ],
          [
            11.393162068583907,
            48.13580045103394
          ],
          [
            11.392371551133882,
            48.13550069701242
          ],
          [
            11.387673362197937,
            48.13343234656755
          ],
          [
            11.386514535481423,
            48.132940726380745
          ],
          [
            11.385463506599002,
            48.132539033221825
          ],
          [
            11.384646039690454,
            48.13228122849417
          ],
          [
            11.383810606476223,
            48.13205939548319
          ],
          [
            11.382786527052327,
            48.13185554808765
          ],
          [
            11.36402072076707,
            48.12885769881913
          ],
          [
            11.359717790556136,
            48.12819814849451
          ],
          [
            11.35860387960383,
            48.12795231393388
          ],
          [
            11.357454036040156,
            48.1275865578976
          ],
          [
            11.353779926528109,
            48.125991591294735
          ],
          [
            11.349387164788764,
            48.12415671882642
          ],
          [
            11.34794087718133,
            48.12344313960895
          ],
          [
            11.346746117853453,
            48.12270556411684
          ],
          [
            11.345551358525572,
            48.121788077382696
          ],
          [
            11.344967453590893,
            48.121260365171246
          ],
          [
            11.344437447573265,
            48.12070266341953
          ],
          [
            11.343404384996527,
            48.11943132066501
          ],
          [
            11.341194529397592,
            48.116510711317254
          ],
          [
            11.340395028794726,
            48.115551131970484
          ],
          [
            11.335364463203657,
            48.110207146701605
          ],
          [
            11.334834457186027,
            48.109727300407286
          ],
          [
            11.334008007124638,
            48.10921745881033
          ],
          [
            11.333199523368929,
            48.10888156040611
          ],
          [
            11.332588668975728,
            48.108701613929334
          ],
          [
            11.332040696652415,
            48.10859364574083
          ],
          [
            11.331393909647849,
            48.10852166682248
          ],
          [
            11.329300835035852,
            48.10847967907356
          ],
          [
            11.328474384974461,
            48.10847967907356
          ],
          [
            11.327081996284075,
            48.10858764750149
          ],
          [
            11.326093849471544,
            48.108767594377305
          ],
          [
            11.324800275462412,
            48.109145480765676
          ],
          [
            11.322015498081642,
            48.1100511971474
          ],
          [
            11.320973452352062,
            48.11029711738299
          ],
          [
            11.320398530570225,
            48.11038108987683
          ],
          [
            11.319805642482708,
            48.110417078046474
          ],
          [
            11.31870071468324,
            48.1103750918461
          ],
          [
            11.31809884344288,
            48.11030311542281
          ],
          [
            11.317128662936032,
            48.110105179738945
          ],
          [
            11.316733404211018,
            48.10999121642361
          ],
          [
            11.311909451135296,
            48.10852766506954
          ],
          [
            11.310588927667641,
            48.10820375872724
          ],
          [
            11.309744511300568,
            48.10808379289723
          ],
          [
            11.30885517916929,
            48.10802980818236
          ],
          [
            11.306285997456708,
            48.108053801395975
          ],
          [
            11.305279884338495,
            48.10802380987721
          ],
          [
            11.30449835004131,
            48.10790984194631
          ],
          [
            11.303959360870838,
            48.10778387709707
          ],
          [
            11.30344732115889,
            48.10761592348449
          ],
          [
            11.302944264599784,
            48.10741197907421
          ],
          [
            11.29983609371673,
            48.10579239179075
          ],
          [
            11.293853313924494,
            48.10266104499417
          ],
          [
            11.292793301889233,
            48.102079145357244
          ],
          [
            11.291733289853973,
            48.10137125856777
          ],
          [
            11.288975461931726,
            48.09915155034549
          ],
          [
            11.2859391562714,
            48.096709760601854
          ],
          [
            11.284888127388982,
            48.095941802755185
          ],
          [
            11.265771978142919,
            48.082824751917315
          ],
          [
            11.26473891556618,
            48.082158609303185
          ],
          [
            11.263292627958748,
            48.081414439785426
          ],
          [
            11.258073416158012,
            48.07906183308058
          ],
          [
            11.25661814539774,
            48.07843765405981
          ],
          [
            11.255782712183509,
            48.078179577828784
          ],
          [
            11.252018771143048,
            48.07744135262471
          ],
          [
            11.248856701342948,
            48.076799148100065
          ],
          [
            11.247796689307688,
            48.07647504183844
          ],
          [
            11.247302615901422,
            48.07622895979476
          ],
          [
            11.246844475106519,
            48.07593486019871
          ],
          [
            11.24633243539457,
            48.075496708703106
          ],
          [
            11.245892260905354,
            48.07497452328044
          ],
          [
            11.245020895079756,
            48.07363602380054
          ],
          [
            11.244607670049062,
            48.073191850359734
          ],
          [
            11.24421241132405,
            48.07286772137505
          ],
          [
            11.243574607472324,
            48.07248356586047
          ],
          [
            11.242855955245028,
            48.0721654349041
          ],
          [
            11.242245100851827,
            48.071985359906144
          ],
          [
            11.241400684484754,
            48.07179327921375
          ],
          [
            11.232148037058325,
            48.0700285042988
          ],
          [
            11.223533193483618,
            48.068077577246264
          ],
          [
            11.22271572657507,
            48.067891484956135
          ],
          [
            11.221898259666519,
            48.06766337090836
          ],
          [
            11.220955028618194,
            48.06729118265985
          ],
          [
            11.220191460626692,
            48.066858960671
          ],
          [
            11.219508741010763,
            48.06633668759166
          ],
          [
            11.218727206713579,
            48.06559829247108
          ],
          [
            11.218322964835725,
            48.06525610577446
          ],
          [
            11.217496514774334,
            48.06474582314161
          ],
          [
            11.216885660381134,
            48.06445766130216
          ],
          [
            11.216131075542473,
            48.06416949784949
          ],
          [
            11.215466322232224,
            48.0640014017571
          ],
          [
            11.214999198284483,
            48.06391135005321
          ],
          [
            11.214029017777634,
            48.0638032878006
          ],
          [
            11.212681544851455,
            48.063761263529976
          ],
          [
            11.211639499121876,
            48.06370122879816
          ],
          [
            11.210947796353103,
            48.06358716261479
          ],
          [
            11.210336941959904,
            48.063431071638455
          ],
          [
            11.20949252559283,
            48.063106881175194
          ],
          [
            11.208935570116676,
            48.06280670299983
          ],
          [
            11.206564017766599,
            48.060957566836414
          ],
          [
            11.205324342674515,
            48.059882876014484
          ],
          [
            11.204848235573932,
            48.05938454807594
          ],
          [
            11.204515858918807,
            48.05891623549616
          ],
          [
            11.204237381180732,
            48.05835785723722
          ],
          [
            11.204138566499477,
            48.058057651368955
          ],
          [
            11.204066701276748,
            48.057469242789274
          ],
          [
            11.204129583346637,
            48.05697689574895
          ],
          [
            11.204318229556302,
            48.056436509431414
          ],
          [
            11.20506383124212,
            48.05518759490772
          ],
          [
            11.20536027528588,
            48.05448506717535
          ],
          [
            11.20543214050861,
            48.053704469564074
          ],
          [
            11.205243494298944,
            48.052221301500865
          ],
          [
            11.20536027528588,
            48.05157878223629
          ],
          [
            11.205710618246686,
            48.05085819034646
          ],
          [
            11.2059531633734,
            48.0505219106805
          ],
          [
            11.206752663976266,
            48.04965117634138
          ],
          [
            11.207273686841054,
            48.04892455227927
          ],
          [
            11.207426400439354,
            48.048564239024735
          ],
          [
            11.20755216457913,
            48.04800574849842
          ],
          [
            11.207525215120608,
            48.04736317663694
          ],
          [
            11.207453349897879,
            48.047062906663534
          ],
          [
            11.207264703688214,
            48.046582471064866
          ],
          [
            11.206995209102978,
            48.04612605309512
          ],
          [
            11.206438253626825,
            48.045537508163925
          ],
          [
            11.20589028130351,
            48.04512912609625
          ],
          [
            11.205225527993262,
            48.04476878628879
          ],
          [
            11.20482128611541,
            48.04460062684928
          ],
          [
            11.203949920289812,
            48.04431235224717
          ],
          [
            11.202404818001128,
            48.04385591416094
          ],
          [
            11.201847862524973,
            48.04366372849357
          ],
          [
            11.201066328227789,
            48.04332139599738
          ],
          [
            11.200563271668683,
            48.043015096572326
          ],
          [
            11.200311743389127,
            48.04282290776785
          ],
          [
            11.198874438934537,
            48.04157366306061
          ],
          [
            11.198092904637353,
            48.04080488202879
          ],
          [
            11.196628650724238,
            48.03949552542466
          ],
          [
            11.193915738566197,
            48.03668450067398
          ],
          [
            11.193268951561631,
            48.036077827774974
          ],
          [
            11.192190973220688,
            48.03516480163061
          ],
          [
            11.189235515935934,
            48.03291820789572
          ],
          [
            11.188480931097274,
            48.032305483513724
          ],
          [
            11.185965648301739,
            48.03013085385592
          ],
          [
            11.18130339197716,
            48.02629198803812
          ],
          [
            11.180503891374293,
            48.02570922441108
          ],
          [
            11.177934709661711,
            48.02417718550889
          ],
          [
            11.177234023740098,
            48.02364246317195
          ],
          [
            11.173452116393955,
            48.01995933729654
          ],
          [
            11.17311075658599,
            48.019502683453005
          ],
          [
            11.172823295695071,
            48.0188417299364
          ],
          [
            11.172715497860976,
            48.01798247769657
          ],
          [
            11.172472952734266,
            48.007790533830196
          ],
          [
            11.172419053817217,
            48.006816905492045
          ],
          [
            11.172257357066076,
            48.0058973507407
          ],
          [
            11.171269210253545,
            48.00170806052512
          ],
          [
            11.170918867292738,
            48.000553992545875
          ],
          [
            11.170397844427947,
            47.99846217852803
          ]
        ]
      },
      "properties": {
        "name": "S8",
        "color": "#000000"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "LineString",
        "coordinates": [
          [
            11.697322640633937,
            47.884468583110234
          ],
          [
            11.694277351820771,
            47.887028869158094
          ],
          [
            11.693540733287794,
            47.88757103114258
          ],
          [
            11.69202258045763,
            47.88896255425956
          ],
          [
            11.691492574440002,
            47.88955890986477
          ],
          [
            11.690908669505323,
            47.8903118743049
          ],
          [
            11.690423579251899,
            47.8910347098681
          ],
          [
            11.689803741705855,
            47.892076780047915
          ],
          [
            11.689435432439367,
            47.89276947405634
          ],
          [
            11.688824578046166,
            47.89414278782497
          ],
          [
            11.682437556376076,
            47.91069196790386
          ],
          [
            11.682141112332316,
            47.9113422643124
          ],
          [
            11.681305679118084,
            47.913395461377156
          ],
          [
            11.67803581148389,
            47.92196863558883
          ],
          [
            11.66120138305949,
            47.965396650818455
          ],
          [
            11.660806124334478,
            47.966268808768994
          ],
          [
            11.660087472107183,
            47.967622128157025
          ],
          [
            11.659440685102616,
            47.96866867083606
          ],
          [
            11.658659150805432,
            47.9697753365765
          ],
          [
            11.657922532272453,
            47.97073162102416
          ],
          [
            11.657096082211064,
            47.97169390196439
          ],
          [
            11.654859277153605,
            47.97397924733353
          ],
          [
            11.654688597249624,
            47.97419574849216
          ],
          [
            11.65406875970358,
            47.9747069281814
          ],
          [
            11.652532640567737,
            47.975861574265615
          ],
          [
            11.651544493755205,
            47.976553146795666
          ],
          [
            11.64985566102106,
            47.97762356253394
          ],
          [
            11.648166828286916,
            47.97857368824916
          ],
          [
            11.59249823013003,
            48.008427589338424
          ],
          [
            11.590908212077139,
            48.00935911860426
          ],
          [
            11.589704469596418,
            48.01020048541476
          ],
          [
            11.58889598584071,
            48.01086154970774
          ],
          [
            11.587809024346925,
            48.011919234950646
          ],
          [
            11.586973591132693,
            48.01292882335499
          ],
          [
            11.586416635656539,
            48.01373407612619
          ],
          [
            11.586147141071304,
            48.01419679031312
          ],
          [
            11.58469187031103,
            48.017123211136095
          ],
          [
            11.583613891970087,
            48.01946062302713
          ],
          [
            11.582544896781986,
            48.02180393730903
          ],
          [
            11.58189810977742,
            48.02334205493115
          ],
          [
            11.581799295096165,
            48.02377464224327
          ],
          [
            11.581799295096165,
            48.02429734706847
          ],
          [
            11.581880143471736,
            48.02466984612304
          ],
          [
            11.58213167175129,
            48.02527665333457
          ],
          [
            11.582401166336526,
            48.02569720859686
          ],
          [
            11.583012020729726,
            48.02634605855607
          ],
          [
            11.591294487649309,
            48.033687106616114
          ],
          [
            11.593737905222115,
            48.035903633246356
          ],
          [
            11.606763476841847,
            48.047513310967176
          ],
          [
            11.607419246999253,
            48.04825797077639
          ],
          [
            11.607931286711203,
            48.04897259385608
          ],
          [
            11.608236713907804,
            48.049483032842005
          ],
          [
            11.609458422694205,
            48.051873021025365
          ],
          [
            11.61151556469484,
            48.05631642281284
          ],
          [
            11.611829975044282,
            48.05734915857942
          ],
          [
            11.6119647223369,
            48.0580696596373
          ],
          [
            11.612081503323834,
            48.05992490345138
          ],
          [
            11.612180318005088,
            48.06069940293216
          ],
          [
            11.612386930520437,
            48.06522008598986
          ],
          [
            11.612476762048848,
            48.067381228450664
          ],
          [
            11.6124228631318,
            48.06789748794374
          ],
          [
            11.609467405847047,
            48.07957797539674
          ],
          [
            11.606484999103769,
            48.09135181554901
          ],
          [
            11.60634126865831,
            48.09183183339422
          ],
          [
            11.605820245793522,
            48.09316985948465
          ],
          [
            11.60529023977589,
            48.0942738547971
          ],
          [
            11.60430209296336,
            48.09601379929059
          ],
          [
            11.604140396212218,
            48.096499773267574
          ],
          [
            11.601679012333731,
            48.10035140452941
          ],
          [
            11.600241707879139,
            48.10244508301103
          ],
          [
            11.599882381765491,
            48.10307496959247
          ],
          [
            11.598975083328531,
            48.105036566926216
          ],
          [
            11.598642706673408,
            48.105636428839915
          ],
          [
            11.597115570690404,
            48.10908549898479
          ],
          [
            11.596082508113666,
            48.111130838204325
          ],
          [
            11.59557945155456,
            48.11227643252217
          ],
          [
            11.595498603178987,
            48.112552331002576
          ],
          [
            11.595274024357957,
            48.11376386766396
          ],
          [
            11.595157243371023,
            48.11511931541757
          ],
          [
            11.595193175982388,
            48.11593496585974
          ],
          [
            11.595300973816483,
            48.11654069788307
          ],
          [
            11.595777080917065,
            48.11856175207725
          ],
          [
            11.595938777668207,
            48.119203435147966
          ],
          [
            11.596145390183555,
            48.12011497115098
          ],
          [
            11.596316070087537,
            48.12078661890905
          ],
          [
            11.59656759836709,
            48.12133832299829
          ],
          [
            11.59700777285631,
            48.121908011220164
          ],
          [
            11.597798290306335,
            48.122597625351595
          ],
          [
            11.601786810167825,
            48.12557785126585
          ],
          [
            11.60265817599342,
            48.12609952292806
          ],
          [
            11.604068530989489,
            48.12679507690223
          ],
          [
            11.605532784902604,
            48.1277124742041
          ],
          [
            11.604068530989489,
            48.12679507690223
          ],
          [
            11.60265817599342,
            48.12609952292806
          ],
          [
            11.602235967809884,
            48.12593762539303
          ],
          [
            11.601687995486571,
            48.12579371604457
          ],
          [
            11.6011490063161,
            48.125709768738425
          ],
          [
            11.600663916062675,
            48.1256737912795
          ],
          [
            11.600214758420616,
            48.12565580254061
          ],
          [
            11.599756617625713,
            48.12566779503391
          ],
          [
            11.599307459983654,
            48.12572775745843
          ],
          [
            11.598885251800118,
            48.125829693419476
          ],
          [
            11.59835524578249,
            48.126009579916044
          ],
          [
            11.597825239764857,
            48.12627341230469
          ],
          [
            11.594600287894869,
            48.12821613634299
          ],
          [
            11.593073151911865,
            48.12918747080512
          ],
          [
            11.589964981028812,
            48.131190040662986
          ],
          [
            11.589390059246975,
            48.13151979767215
          ],
          [
            11.588842086923663,
            48.131765615155885
          ],
          [
            11.58844682819865,
            48.131903512253515
          ],
          [
            11.586731046005982,
            48.13233518773032
          ],
          [
            11.58551832037242,
            48.132796836655174
          ],
          [
            11.58438644311443,
            48.133348411746915
          ],
          [
            11.583137784869503,
            48.1342117347786
          ],
          [
            11.581493867899566,
            48.135200941240896
          ],
          [
            11.581035727104664,
            48.13541676557279
          ],
          [
            11.579975715069404,
            48.13575848557627
          ],
          [
            11.577837724693198,
            48.13632201885972
          ],
          [
            11.576436352849973,
            48.136849576328004
          ],
          [
            11.575394307120394,
            48.13714332756875
          ],
          [
            11.572618512892465,
            48.13776679402077
          ],
          [
            11.571342905189015,
            48.138156456708565
          ],
          [
            11.570705101337289,
            48.138300331414925
          ],
          [
            11.570166112166817,
            48.13838425814076
          ],
          [
            11.569115083284396,
            48.138480174230885
          ],
          [
            11.567821509275266,
            48.13869598477844
          ],
          [
            11.566339289056469,
            48.13909762977105
          ],
          [
            11.566078777624075,
            48.13919953919477
          ],
          [
            11.565620636829173,
            48.13948728235796
          ],
          [
            11.563877905177982,
            48.14015867680017
          ],
          [
            11.561865678941553,
            48.140794095595304
          ],
          [
            11.560024132609108,
            48.141255668467565
          ],
          [
            11.559027002643735,
            48.141441495335265
          ],
          [
            11.556862062809008,
            48.14194502282168
          ],
          [
            11.555056449087926,
            48.14224473921864
          ],
          [
            11.554445594694727,
            48.142280705068686
          ],
          [
            11.553879656065732,
            48.14226272214681
          ],
          [
            11.55311608807423,
            48.14216681312378
          ],
          [
            11.55153505317418,
            48.14192104543432
          ],
          [
            11.550519956903123,
            48.14184311884807
          ],
          [
            11.549495877479227,
            48.14184311884807
          ],
          [
            11.548525696972378,
            48.14190306238646
          ],
          [
            11.543665811285292,
            48.14229868798425
          ],
          [
            11.541707483965912,
            48.142394596760894
          ],
          [
            11.538545414165812,
            48.142622379387234
          ],
          [
            11.536524204776542,
            48.14267033349556
          ],
          [
            11.53244585338664,
            48.14272428181388
          ],
          [
            11.53072108804113,
            48.142688316274636
          ],
          [
            11.519240618710082,
            48.14355747641903
          ],
          [
            11.517084662028195,
            48.14354548810335
          ],
          [
            11.51373394601843,
            48.143407622271695
          ],
          [
            11.512602068760438,
            48.14341361644599
          ],
          [
            11.511721719782,
            48.14345557564644
          ],
          [
            11.507140311832993,
            48.143917124587716
          ],
          [
            11.503708747447655,
            48.14434270499872
          ],
          [
            11.49811224322759,
            48.144858192038626
          ],
          [
            11.496890534441189,
            48.14501403593851
          ],
          [
            11.493009812413792,
            48.145589455469775
          ],
          [
            11.492354042256384,
            48.1456613824576
          ],
          [
            11.491455726972266,
            48.145703339820614
          ],
          [
            11.48848230338183,
            48.14569135200612
          ],
          [
            11.487745684848852,
            48.145715327632324
          ],
          [
            11.487386358735204,
            48.145703339820614
          ],
          [
            11.473417556067144,
            48.14675226274896
          ],
          [
            11.472007201071078,
            48.146890119597145
          ],
          [
            11.470489048240916,
            48.147141857234004
          ],
          [
            11.469599716109638,
            48.14735163765486
          ],
          [
            11.468863097576659,
            48.14756741090745
          ],
          [
            11.467147315383992,
            48.14812482094457
          ],
          [
            11.464443386378791,
            48.1491077658288
          ],
          [
            11.461766406832115,
            48.14995883704555
          ],
          [
            11.45946671970477,
            48.150684034480115
          ],
          [
            11.457912634263243,
            48.151265383700526
          ],
          [
            11.456062104777956,
            48.151810767187925
          ],
          [
            11.454427170960859,
            48.15218234382646
          ],
          [
            11.451390865300535,
            48.15263182809965
          ],
          [
            11.449872712470372,
            48.153009391846425
          ],
          [
            11.449064228714665,
            48.153261099467535
          ],
          [
            11.448040149290769,
            48.153668623474374
          ],
          [
            11.44729454760495,
            48.15401621492259
          ],
          [
            11.446548945919131,
            48.15442972582
          ],
          [
            11.446036906207182,
            48.1547593335688
          ],
          [
            11.442299914625245,
            48.15745604470929
          ],
          [
            11.440440401987116,
            48.158672514676354
          ],
          [
            11.438446142056371,
            48.15982304100995
          ],
          [
            11.43249031172266,
            48.16307673362372
          ],
          [
            11.408846653444634,
            48.17602354640746
          ],
          [
            11.406169673897958,
            48.177557056886585
          ],
          [
            11.390242543910519,
            48.18621214457422
          ],
          [
            11.373839306822497,
            48.195183142591794
          ],
          [
            11.364730389841524,
            48.2000512577669
          ],
          [
            11.361496454818695,
            48.20161398632394
          ],
          [
            11.360301695490815,
            48.20216482180792
          ],
          [
            11.357750480083917,
            48.20325450064216
          ],
          [
            11.354552477672451,
            48.2045237676395
          ],
          [
            11.35094125023029,
            48.20579899007003
          ],
          [
            11.345452543844319,
            48.207517197312036
          ],
          [
            11.343332519773798,
            48.2081338220924
          ],
          [
            11.341122664174863,
            48.20872649328203
          ],
          [
            11.338661280296376,
            48.209307184664006
          ],
          [
            11.33546327788491,
            48.21000759746701
          ],
          [
            11.33403495658316,
            48.210247052638195
          ],
          [
            11.332202393403557,
            48.21060623329558
          ],
          [
            11.33080102156033,
            48.21082772677852
          ],
          [
            11.324997904824919,
            48.21153410500013
          ],
          [
            11.321593289898106,
            48.21188729045697
          ],
          [
            11.318512068473575,
            48.21207286150045
          ],
          [
            11.316948999879207,
            48.21220455667172
          ],
          [
            11.314155239345595,
            48.212342237624995
          ],
          [
            11.30050983017982,
            48.21274929219124
          ],
          [
            11.294958241723961,
            48.21297077640472
          ],
          [
            11.266814023872497,
            48.21389261932574
          ],
          [
            11.262502110508724,
            48.21400036611635
          ],
          [
            11.257929685712554,
            48.214144028151146
          ],
          [
            11.255612032279526,
            48.21424578851524
          ],
          [
            11.245901244058194,
            48.21452113907471
          ],
          [
            11.241373735026231,
            48.214712686416654
          ],
          [
            11.228626641144576,
            48.215119722139015
          ],
          [
            11.221862327055156,
            48.21532922455829
          ],
          [
            11.21903263391018,
            48.21544893984156
          ],
          [
            11.19700594314357,
            48.2161372972883
          ],
          [
            11.185579372729567,
            48.216436580248114
          ],
          [
            11.178662345041849,
            48.21672389024364
          ],
          [
            11.176093163329266,
            48.216855573452776
          ]
        ]
      },
      "properties": {
        "name": "S3",
        "color": "#8d1890"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "LineString",
        "coordinates": [
          [
            11.596082508113666,
            48.111130838204325
          ],
          [
            11.597115570690404,
            48.10908549898479
          ],
          [
            11.598642706673408,
            48.105636428839915
          ],
          [
            11.598975083328531,
            48.105036566926216
          ],
          [
            11.599882381765491,
            48.10307496959247
          ],
          [
            11.600241707879139,
            48.10244508301103
          ],
          [
            11.601679012333731,
            48.10035140452941
          ],
          [
            11.604140396212218,
            48.096499773267574
          ],
          [
            11.604418873950294,
            48.096325783112334
          ],
          [
            11.604742267452579,
            48.09598380074641
          ],
          [
            11.605110576719067,
            48.09567181484955
          ],
          [
            11.605496852291237,
            48.09541382508179
          ],
          [
            11.60596397623898,
            48.095155834019536
          ],
          [
            11.606574830632182,
            48.09490384149972
          ],
          [
            11.607032971427083,
            48.094759845219635
          ],
          [
            11.607760606807219,
            48.094597848922504
          ],
          [
            11.608335528589055,
            48.09451985052334
          ],
          [
            11.62693065497033,
            48.09374585999625
          ],
          [
            11.628826100219822,
            48.09360786046142
          ],
          [
            11.629733398656784,
            48.093583860504516
          ],
          [
            11.63152104607218,
            48.093409860481934
          ],
          [
            11.636201268702443,
            48.09302585834858
          ],
          [
            11.636991786152468,
            48.09293585743375
          ],
          [
            11.63812366341046,
            48.09273785486665
          ],
          [
            11.63918367544572,
            48.09247385025785
          ],
          [
            11.63963283308778,
            48.09232984717268
          ],
          [
            11.640647929358835,
            48.091945836973984
          ],
          [
            11.641079120695213,
            48.09174783059476
          ],
          [
            11.64219303164752,
            48.09114180633275
          ],
          [
            11.642911683874816,
            48.09064378104854
          ],
          [
            11.645004758486815,
            48.088813646710534
          ],
          [
            11.647052917334607,
            48.08697744648228
          ],
          [
            11.648912429972734,
            48.08537521821653
          ],
          [
            11.657140997975269,
            48.07799352206845
          ],
          [
            11.657796768132677,
            48.07747136198589
          ],
          [
            11.660213236246959,
            48.0758568334931
          ],
          [
            11.663501070186836,
            48.073539986624695
          ],
          [
            11.678377171291855,
            48.063323008377566
          ],
          [
            11.68833948779274,
            48.05641249213011
          ],
          [
            11.68961509549619,
            48.05532569752264
          ],
          [
            11.697529253149284,
            48.04784360495318
          ],
          [
            11.698795877699892,
            48.04657646559152
          ],
          [
            11.711012965563917,
            48.035080706303596
          ],
          [
            11.712099927057702,
            48.03411360017803
          ],
          [
            11.71623217736465,
            48.03016089080216
          ],
          [
            11.716681335006712,
            48.02967429011766
          ],
          [
            11.7172023578715,
            48.028851263687805
          ],
          [
            11.717462869303896,
            48.02811833857703
          ],
          [
            11.71845999926927,
            48.02418920167745
          ],
          [
            11.718612712867568,
            48.0233540712944
          ],
          [
            11.719187634649405,
            48.01864945095865
          ],
          [
            11.719537977610212,
            48.0160175603677
          ],
          [
            11.719555943915893,
            48.01530848924454
          ],
          [
            11.719780522736924,
            48.01368600168685
          ],
          [
            11.719933236335224,
            48.01309107679066
          ],
          [
            11.720166798309096,
            48.01247811668829
          ],
          [
            11.720445276047172,
            48.011901206406655
          ],
          [
            11.72079561900798,
            48.01133029925341
          ],
          [
            11.72358937954159,
            48.00749604324704
          ],
          [
            11.724766172563788,
            48.0059334120202
          ],
          [
            11.725502791096766,
            48.005079954976416
          ],
          [
            11.728179770643441,
            48.00235120178953
          ],
          [
            11.728979271246308,
            48.00155178199763
          ],
          [
            11.729419445735525,
            48.00118512667089
          ],
          [
            11.73012911480998,
            48.0007162849155
          ],
          [
            11.73191676222538,
            47.99976055583375
          ],
          [
            11.73246473454869,
            47.99943596457069
          ],
          [
            11.733183386775986,
            47.998906996655045
          ],
          [
            11.733551696042477,
            47.99852830038419
          ],
          [
            11.733749325404982,
            47.99829987906729
          ],
          [
            11.734809337440243,
            47.99670691281851
          ],
          [
            11.736596984855643,
            47.99388754256872
          ],
          [
            11.738169036602851,
            47.99163313782511
          ],
          [
            11.739130233956859,
            47.99046080843497
          ],
          [
            11.739821936725631,
            47.989727337529665
          ],
          [
            11.74085499930237,
            47.988753368248716
          ],
          [
            11.741519752612616,
            47.98820625398521
          ],
          [
            11.742507899425147,
            47.98744870158381
          ],
          [
            11.743972153338264,
            47.98648070177836
          ],
          [
            11.75476990305338,
            47.97993269843692
          ],
          [
            11.756386870564794,
            47.97889841075027
          ],
          [
            11.757455865752897,
            47.97810464103073
          ],
          [
            11.766888176236153,
            47.970857921419835
          ],
          [
            11.769268711739068,
            47.96899345563146
          ]
        ]
      },
      "properties": {
        "name": "S5"
      }
    }
  ]
};
        // ============================================================

        // --- CONFIG ---
        const API_KEY = "5cc87b12d7c5370001c1d655112ec5c21e0f441792cfc2fafe3e7a1e"; 
        const BBOX = "1269000 6087000 1350000 6200000 5 tenant=sbm";

        // --- MAP SETUP ---
        console.log("Creating map...");
        var map = L.map('map', { zoomControl: false, zoomSnap: 0, zoomDelta: 0.1 }).setView([48.137, 11.575], 11);
        console.log("Map created.");

        L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
            attribution: 'CARTO',
            maxZoom: 20
        }).addTo(map);

        // --- LOAD ROUTES ---
        if (ROUTES_DATA && ROUTES_DATA.features && ROUTES_DATA.features.length > 0) {
            console.log("Loading routes...");
            L.geoJSON(ROUTES_DATA, {
                style: function(feature) {
                    return {
                        color: feature.properties.color || '#005293', // S-Bahn Blue
                        weight: 3,
                        opacity: 0.7
                    };
                }
            }).addTo(map);
            console.log("Routes loaded.");
        }

        var stationLayer = L.layerGroup().addTo(map);
        var trainLayer = L.layerGroup().addTo(map);
        var markers = {};
        var trainData = {};

        function mercatorToLatLon(x, y) {
            var lon = (x / 20037508.34) * 180;
            var lat = (y / 20037508.34) * 180;
            lat = 180 / Math.PI * (2 * Math.atan(Math.exp(lat * Math.PI / 180)) - Math.PI / 2);
            return [lat, lon];
        }

        const ws = new WebSocket(`wss://api.geops.io/realtime-ws/v1/?key=${API_KEY}`);

        ws.onopen = function() {
            console.log("WS Connected");
            ws.send("BUFFER 100 100");
            ws.send("BBOX " + BBOX);
            ws.send("GET station");
        };

        ws.onmessage = function(event) {
            try {
                var msg = JSON.parse(event.data);
                var items = [];
                var source = msg.source;
                if (source === 'list') items = msg.content;
                else if (source === 'trajectory' || source === 'station') items = [msg];
                else if (source === 'buffer') items = msg.content;
                if (!items) return;

                items.forEach(item => {
                    if (typeof item === 'string') return;
                    var content = item.content || item;
                    var props = content.properties || {};
                    var geom = content.geometry || {};
                    var type = item.source || source;

                    if (type === 'station') {
                        var mot = props.mot || {};
                        if (!mot.rail && !mot.subway) return;
                        var name = props.name || "Station";
                        var coords = geom.coordinates;
                        if (coords && coords.length === 2) {
                            var ll = mercatorToLatLon(coords[0], coords[1]);
                            L.circleMarker(ll, {
                                radius: 4, fillColor: "white", color: "#005293",
                                weight: 2, opacity: 1, fillOpacity: 1
                            }).bindPopup("<b>" + name + "</b>").addTo(stationLayer);
                        }
                    }

                    if (type === 'trajectory') {
                        var id = props.train_id;
                        var color = props.line ? props.line.color : '#FF0000';
                        var textColor = props.line ? props.line.text_color : '#FFFFFF';
                        var lineName = props.line ? props.line.name : '?';
                        var state = props.state || 'DRIVING';
                        var coordsPoly = geom.coordinates || [];
                        var intervals = props.time_intervals || [];
                        
                        var lat = 0, lon = 0, nextLat = null, nextLon = null;
                        var startTs = 0, nextTs = null;
                        var heading = null;

                        if (coordsPoly.length >= 2) {
                            var p0 = coordsPoly[0], p1 = coordsPoly[1];
                            var dx = p1[0] - p0[0], dy = p1[1] - p0[1];
                            if (Math.abs(dx) > 0.1 || Math.abs(dy) > 0.1) {
                                var theta = Math.atan2(dy, dx);
                                heading = (450 - (theta * 180 / Math.PI)) % 360;
                            }
                            var ll0 = mercatorToLatLon(p0[0], p0[1]);
                            lat = ll0[0]; lon = ll0[1];
                            var ll1 = mercatorToLatLon(p1[0], p1[1]);
                            nextLat = ll1[0]; nextLon = ll1[1];
                        } else if (props.raw_coordinates) {
                            lon = props.raw_coordinates[0];
                            lat = props.raw_coordinates[1];
                        }

                        if (intervals.length >= 2) {
                            startTs = intervals[0][0] / 1000.0;
                            nextTs = intervals[1][0] / 1000.0;
                        } else startTs = (props.timestamp || Date.now()) / 1000.0;

                        if (lat !== 0) {
                            trainData[id] = {
                                id: lineName, lat: lat, lon: lon,
                                next_lat: nextLat, next_lon: nextLon,
                                start_ts: startTs, next_ts: nextTs,
                                color: color, text_color: textColor,
                                state: state, heading: heading,
                                ts: Date.now() / 1000
                            };
                            updateMarker(id);
                        }
                    }
                });
            } catch(e) { console.error("Parse Error:", e); }
        };

        function updateMarker(id) {
            var t = trainData[id];
            var isBoarding = (t.state === 'BOARDING' || t.state === 'STOPPING');
            var arrowStyle = (t.heading !== null) ? `transform: rotate(${t.heading}deg); color: ${t.color};` : 'display: none;';
            var html = `<div class="icon-container"><div class="train-circle ${isBoarding ? 'boarding' : 'driving'}" style="background-color: ${t.color}; color: ${t.text_color};">${t.id}</div><div class="arrow-pointer" style="${arrowStyle}"></div></div>`;
            var icon = L.divIcon({ className: 'custom-train-icon', html: html, iconSize: [30, 30], iconAnchor: [15, 15] });
            if (!markers[id]) markers[id] = L.marker([t.lat, t.lon], {icon: icon}).addTo(trainLayer);
            else markers[id].setIcon(icon);
        }

        function animate() {
            var now = Date.now() / 1000; 
            Object.keys(trainData).forEach(id => {
                var t = trainData[id];
                var marker = markers[id];
                if (now - t.ts > 60) {
                    trainLayer.removeLayer(marker); delete markers[id]; delete trainData[id]; return;
                }
                var isBoarding = (t.state === 'BOARDING' || t.state === 'STOPPING');
                if (!isBoarding && t.next_lat && t.next_lon && t.next_ts && t.start_ts) {
                    var total = t.next_ts - t.start_ts;
                    var elapsed = now - t.start_ts;
                    if (total > 0) {
                        var p = Math.max(0, Math.min(elapsed / total, 1.05));
                        marker.setLatLng([t.lat + (t.next_lat - t.lat) * p, t.lon + (t.next_lon - t.lon) * p]);
                    } else marker.setLatLng([t.next_lat, t.next_lon]);
                } else marker.setLatLng([t.lat, t.lon]);
            });
            requestAnimationFrame(animate);
        }
        requestAnimationFrame(animate);

    } catch(err) {
        alert("Critical Error: " + err.message);
        console.error(err);
    }
    </script>
</body>
</html>
